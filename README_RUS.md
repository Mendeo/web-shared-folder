# web-shared-folder
Удобный http-сервер на nodejs. Разработан для того, чтобы делиться файлами и папками в локальной сети или даже в Интернете. Также может использоваться как веб-сервер для обслуживания статических сайтов.

# Установка
```
npm i -g web-shared-folder
```

## Запуск

```bash
wsf </path/to/folder/for/sharing> <port> [</path/to/key> </path/to/cert>] [--upload or -u]
```
Вместо *wsf* для запуска можно использовать полное имя программы *web-shared-folder*

Для работы сервера минимально требуется указать путь к директории, которую нужно расшарить и номер порта, на котором будет работать сервер.
Путь к папке указывается в первом параметре. Далее указывается номер порта.

Сервер web-shared-folder работает следующим образом:
Если в корне указанной директории есть файл index.html, то web-shared-folder начинает работать как web-сервер, который обслуживает статический сайт и при запросе на корневой URL отдаст index.html.
В противном случае сервер переходит в режим отображения содержимого указанной в параметрах запуска директории. В этом случае пользователь может скачивать находящиеся в этой директории файлы и папки.

Пример:

```
wsf . 80
```

Пусть в текущей папке нет файла index.html, тогда эта команда запустит сервер на 80 порту и расшарит для обзора и скачивания текущую папку.
Сервер будет доступен на всех имеющихся сетевых интерфейсах. Например, для доступа через localhost в браузере можно набрать http://127.0.0.1.

![Загрузка на сервер запрещена](https://github.com/Mendeo/web-shared-folder/blob/master/img/screenshot_upload_disabled.png)  
*Загрузка на сервер запрещена*

Если же требуется дать возможность пользователям закачивать файлы на сервер в расшаренную папку, а также иметь возможность переименовывать удалять и перемещать имеющиеся файлы и папки, то сервер web-shared-folder должен запускаться с ключом --upload или -u

```
wsf . 80 -u
```

![Загрузка на сервер разрешена](https://github.com/Mendeo/web-shared-folder/blob/master/img/screenshot_upload_enabled.png)  
*Загрузка на сервер разрешена*




Ссылка в виде глаза напротив файла, позволяет открыть его прямо в браузере в отдельной вкладке. Так можно просматривать, например текст, фотографии или некоторые видео (если кодировку поддерживает браузер).

Если добавить ключ -u или --upload, то сервер запустится в режиме, в котором пользователь может загружать свои файлы в расшаренную папку, а также перемещать, переименовывать или даже удалять расшаренные файлы и папки. Например:



В этом режиме появляются дополнительные элементы управления: кнопки "Удалить выбранное", "Выбрать для копирования или перемещения", поле для перетаскивания файлов, кнопка для создания папки и др.
Так же напротив каждого файла или папки появляется кнопка, позволяющая провести переименование.




Доступные параметры:
* -v или --version - покажет нормер версии.
* -h или --help - покажет справку о работе с программой.
* --upload or -u - включают режим, позволяющий записывать на сервер.


Переменная окружения          |Описание
:-----------------------------|:-
WSF_ALLOWED_INTERFACES        |Список интерфейсов, на которых будет доступен сервер. По умолчанию сервер будет доступен на всех доступных сетевых интерфейсах, однако это не желательно, если требуется, например, ограничить доступ из внешней сети. В этой переменной задаётся список ip адресов (через запятую), на которых будет работать сервер.Например, чтобы был доступ только для localhost можно задать WSF_ALLOWED_INTERFACES=127.0.0.1
WSF_AUTO_REDIRECT_HTTP_PORT   |Когда сервер работает в защищённом режиме (по протоколу HTTPS), то есть возможность включить автоматическую переадресацию клиентов, пытабхихся подключиться по протоколу HTTP. Например, пусть сервер работает на стандартном для HTTPS порту 443. Требуется сделать автоматическое перенаправление клиентов, подключающихся по HTTP (стандартный порт 80), для этого задаётся WSF_AUTO_REDIRECT_HTTP_PORT=80
WSF_CERT                      |Путь к файлу ssl сертификата (fullchain.pem)
WSF_DIRECTORY_MODE            |Если в корневой папке есть файл index.html, то сервер по умолчанию запускается в режиме отображения веб страницы, связанной с index.html, а не в режиме отображения содержимого директории. Для принидительного переключения на режим отображения содержимого директории следует задать WSF_DIRECTORY_MODE=1
WSF_DIRECTORY_MODE_TITLE      |Задаёт заголовок страниц, который отображается на вкладке в браузере. По умолчанию отображается "Удалённый менеджер файлов"
WSF_DISABLE_COMPRESSION       |Позволяет принудительно отключить сжатие файлов при передаче по сети. Требуется для целей отладки и на отображение в браузере не влияет.
WSF_FORBIDDEN_PATHS           |Список путей, относительно в корневой директории, которые не будут отображаться у клиентов.
WSF_ICONS_TYPE                |The server uses the [file-icon-vectors](https://www.npmjs.com/package/file-icon-vectors) npm package to display file icons. Three types of icons are available: "classic", "square-o", "vivid" (see the [package page](https://www.npmjs.com/package/file-icon-vectors) for more details). You can set the **SERVER_ICONS_TYPE** environment variable to one of these values. The default is "square-o". Задать вид иконок для отображения значков файлов и папок. Три возможных варианта: "classic", "square-o" и "vivid". По умолчанию используется "square-o". Подробней [package page](https://www.npmjs.com/package/file-icon-vectors)
WSF_KEY                       |Путь к файлу секретного ключа ssl (privkey.pem)
WSF_PORT                      |Порт, который сервер будет слушать
WSF_ROOT                      |Путь к папке, которую нужно расшарить
WSF_SESSION_TIMEOUT           |Время сессии пользоавтеля. В случае неактивности пользователя в течении этого времени, сессия завершается и при повтороном запросе потребуется снова ввести логин и пароль. По умолчанию это время 30 минут.
WSF_SHOULD_RESTART_WORKER     |Нужно ли перезапускать рабочие процессы в режиме кластера в случае их непредвиденного завершения. По умолчанию эти процессы не перезапускаются.
WSF_SHOW_SYSTEM_FILES_REQUESTS|Заставляет выводить в логи не только запросы к расшаренным файлам, но и запросы к файлам самого приложения web-shared-folder, находящиеся по пути /wsf_app_files, например к /wsf_app_files/favicon.icon и др.
WSF_UPLOAD_ENABLE             |Переводит сервер в режим, в котором пользователь может загружать свои файлы на сервер, а также перемещать и переименовывать и удалять расшаренные файлы.
WSF_USERS                     |Задание этой переменной среды переводит сервер в режим, в котором доступ к расшаренным файлам доступен лишь для заданных пользвателей. Формат этой переменной следующий. Имя пользователя, затем символ @, далее sha256 хэш пароля пользователя, затем путь, к которому будет иметь доступ пользователь, далее двоеточие (:) и аналогиченые данные для других пользователей. Путь должен начинаться с символа /, он должен задаваться относительно корневой директории и указывать на папку. Если в пути есть ошибки, то сервер упадёт только при попытке входа пользователя. Пример: username1@sha256password1InHex/path1/relative/ROOT_PATH:username2@sha256password2InHex/path2/relative/ROOT_PATH
WSF_USE_CLUSTER_MODE          |Переводит сервер в режим работы в виде кластера. В этом режиме запускается несколько копий серверного процесса (рабочие процессы по числу ядер процессора), и нагрузка будет распределена на эти процессы, что позволяет в полной мере задействовать ресуры процессора и увеличить производительность сервера при большом числе запросов к нему. Но этот режим также требует большого количества оперативной памяти. В тоже время, этот режим делает работу сервера более устойчивой, т.к. при задании переменной WSF_SHOULD_RESTART_WORKER в случае сбоев в работе серверных процессов, они будут автоматически перезапущены.
